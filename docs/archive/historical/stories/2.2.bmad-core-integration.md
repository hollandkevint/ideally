# Story 2.2: BMad Method Core Integration

**Epic:** Choose-Your-Adventure Adaptive Coaching Engine  
**Priority:** High (MVP Critical)  
**Story Points:** 13  
**Sprint:** BMad Method MVP

## User Story

**As a strategic thinker using ideally.co,**  
**I want access to proven BMad Method business analysis frameworks within my coaching session,**  
**So that my strategic thinking follows structured, professional-grade processes that deliver consistent results.**

## Acceptance Criteria

### ðŸŽ¯ **Core BMad Method Integration**

1. **Mary's BMad Analyst Persona**
   - [ ] Mary maintains curious, analytical, facilitative style exactly as defined in `analyst.md`
   - [ ] Mary asks probing, objective questions that advance strategic thinking
   - [ ] Mary references BMad Method knowledge base (`bmad-kb.md`) contextually during sessions
   - [ ] Mary seamlessly transitions between different BMad techniques based on user needs

2. **Interactive Elicitation System**
   - [ ] Exact implementation of numbered options (1-9) interactive patterns from `advanced-elicitation.md`
   - [ ] Mary presents choices as numbered lists: "Choose your approach: 1) Market analysis 2) Competitor research 3) Customer interviews"
   - [ ] Users can select by number or describe custom approach
   - [ ] Mary adapts subsequent questions based on user selections

3. **Core BMad Templates Integration**
   - [ ] **Brainstorming Facilitation:** Uses techniques from `brainstorming-techniques.md`
     - Divergent thinking prompts
     - Idea evaluation frameworks
     - Creative constraint techniques
   - [ ] **Project Brief Generation:** Follows `project-brief-tmpl.yaml`
     - Problem statement definition
     - Success criteria establishment
     - Resource and timeline estimation
   - [ ] **Market Research Guidance:** Uses `market-research-tmpl.yaml`
     - TAM/SAM/SOM analysis framework
     - Competitive landscape mapping
     - Customer segment validation
   - [ ] **Competitive Analysis:** Implements `competitor-analysis-tmpl.yaml`
     - Direct/indirect competitor identification
     - Feature comparison matrices
     - Competitive positioning strategies

4. **YAML Template Execution**
   - [ ] Real-time YAML template parsing and execution
   - [ ] Dynamic document generation in right pane (canvas) as templates progress
   - [ ] Template state persistence across session interruptions
   - [ ] Template completion validation and quality checking

### ðŸ§  **Knowledge Base Integration**

5. **Real-Time BMad Knowledge Access**
   - [ ] Mary references `bmad-kb.md` for strategic frameworks and methodologies
   - [ ] Contextual suggestions from knowledge base during conversations
   - [ ] Knowledge base search functionality for users exploring specific topics
   - [ ] Knowledge confidence scoring for Mary's recommendations

6. **Technique Library Integration**
   - [ ] Access to all BMad brainstorming techniques during relevant session phases
   - [ ] Technique recommendation engine based on session context and user preferences
   - [ ] Custom technique adaptation based on user's industry or challenge type

### ðŸ”„ **Session Flow Management**

7. **Smooth BMad Task Transitions**
   - [ ] Mary intelligently suggests next BMad Method steps: "Now that we've explored the market, let's analyze competitors"
   - [ ] Context preservation when switching between different BMad templates
   - [ ] Progress tracking showing completion of BMad Method phases
   - [ ] Session recovery if user returns to incomplete BMad workflows

## Definition of Done

- [ ] All 4 core BMad templates (brainstorming, project brief, market research, competitive analysis) functional
- [ ] Mary consistently demonstrates BMad Method expertise and facilitative style
- [ ] Interactive elicitation system with numbered options working across all BMad techniques
- [ ] YAML template engine processes BMad templates correctly with real-time document generation
- [ ] Knowledge base integration provides contextual BMad Method guidance
- [ ] Session state persistence maintains BMad Method workflow progress
- [ ] Unit tests for YAML template parsing and BMad Method logic
- [ ] Integration tests for complete BMad workflow execution
- [ ] User acceptance testing with real BMad Method scenarios

## Technical Implementation Notes

### BMad Method Engine Architecture

```typescript
// Core BMad Method service
class BmadMethodService {
  private knowledgeBase: BmadKnowledgeBase;
  private templateEngine: YamlTemplateEngine;
  private elicitationSystem: ElicitationSystem;

  async executeBmadTemplate(templateId: string, userContext: UserContext) {
    const template = await this.loadTemplate(templateId);
    const session = await this.initializeSession(template, userContext);
    return this.executeInteractiveWorkflow(session);
  }

  async generateElicitationOptions(context: SessionContext): Promise<ElicitationOption[]> {
    return this.elicitationSystem.generateOptions(context, this.knowledgeBase);
  }
}

// Mary's BMad persona integration
class MaryBmadPersona {
  private bmadMethod: BmadMethodService;
  
  async generateResponse(userInput: string, sessionContext: BmadSessionContext) {
    const bmadContext = await this.bmadMethod.analyzeContext(sessionContext);
    const response = await this.generateBmadGuidedResponse(userInput, bmadContext);
    return this.formatWithElicitationOptions(response, bmadContext);
  }
}
```

### YAML Template Processing

```yaml
# Example: project-brief-tmpl.yaml integration
name: "Project Brief Generation"
description: "Create comprehensive project brief using BMad Method"
phases:
  - id: "problem_definition"
    prompts:
      - "What specific problem are you solving?"
      - "Who experiences this problem most acutely?"
    elicitation_options:
      1: "Customer pain point analysis"
      2: "Market gap identification"  
      3: "Internal process improvement"
    outputs:
      - problem_statement
      - target_audience
```

### Knowledge Base Integration

- Real-time search of `bmad-kb.md` for contextual framework suggestions
- Technique matching based on session type and user responses
- Dynamic knowledge injection into Mary's responses

## BMad Method Alignment

This story implements the **core BMad Method philosophy**:
- **Structured Thinking:** Every session follows proven analytical frameworks
- **Interactive Elicitation:** Users actively participate in discovery through guided choices
- **Evidence-Based Analysis:** Recommendations grounded in BMad Method knowledge base
- **Professional Facilitation:** Mary maintains analytical objectivity while being supportive

## User Testing Scenarios

### Scenario 1: SaaS Startup Market Analysis
**User:** "I need to understand the competitive landscape for my project management tool"  
**Expected BMad Flow:**
1. Mary offers numbered elicitation options for competitor analysis approach
2. Guides through `competitor-analysis-tmpl.yaml` systematically
3. Generated document in right pane with competitor comparison matrix
4. Mary suggests next BMad step: market research or customer validation

**Success Criteria:** User completes structured competitor analysis with actionable insights

### Scenario 2: Feature Validation Session
**User:** "I'm not sure if users will want this collaboration feature"  
**Expected BMad Flow:**
1. Mary references BMad knowledge base for validation frameworks
2. Guides brainstorming session using techniques from `brainstorming-techniques.md`
3. Interactive elicitation for validation approach options
4. Systematic progression through market research template

**Success Criteria:** User has clear validation plan with specific next steps

### Scenario 3: New Business Idea Exploration
**User:** "I have this idea for a food delivery app but for healthy meals"  
**Expected BMad Flow:**
1. Mary initiates project brief template to structure thinking
2. Uses BMad brainstorming techniques for idea development
3. Numbered options for market analysis approaches
4. Seamless transition to competitive analysis template

**Success Criteria:** User completes comprehensive idea analysis with business brief document

## Quality Standards

### Mary's BMad Method Consistency
- [ ] Uses BMad terminology and frameworks appropriately
- [ ] Maintains analytical objectivity while being encouraging
- [ ] References knowledge base naturally in conversation flow
- [ ] Provides numbered elicitation options at decision points

### Template Execution Quality
- [ ] YAML templates parse correctly with proper error handling
- [ ] Generated documents are professional and actionable
- [ ] Template progression is intuitive and user-friendly
- [ ] State persistence works reliably across sessions

---

*This story establishes ideally.co as a true BMad Method implementation, differentiating from generic AI tools through structured strategic thinking workflows.*