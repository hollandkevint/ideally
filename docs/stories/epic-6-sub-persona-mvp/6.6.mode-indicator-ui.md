# Story 6.6: Mode Indicator UI

**Status:** Ready
**Priority:** P2 - Medium
**Estimate:** 2-3 hours
**Depends On:** Story 6.1

## User Story

As a ThinkHaven user, I want to see which mode the AI is in, so that I understand the nature of the feedback I'm receiving.

## Context

After Story 6.1 wires up the sub-persona modes, this story adds visual indicators. The design system already defines mode colors:

```css
--mode-inquisitive: #D4A84B;  /* Warm Gold */
--mode-advocate: #8B4D3B;     /* Deep Terracotta */
--mode-encouraging: #C9A9A6;  /* Dusty Rose */
--mode-realistic: #6B7B8C;    /* Slate Blue */
```

## Acceptance Criteria

1. **Mode badge appears in chat**
   - Small, unobtrusive indicator
   - Shows current mode name
   - Color matches mode

2. **Badge updates on mode shift**
   - Smooth transition animation
   - Brief tooltip explaining shift
   - No jarring UI changes

3. **Mode info accessible**
   - Tooltip on hover explains mode purpose
   - Help icon links to mode documentation
   - First-time user gets brief explanation

4. **Responsive behavior**
   - Works on mobile (smaller badge)
   - Doesn't interfere with chat readability
   - Can be collapsed/hidden if user prefers

## Technical Implementation

### Files to Create/Modify

1. **`app/components/ui/ModeBadge.tsx`** (new)
   - Mode indicator component
   - Color and tooltip logic
   - Animation for transitions

2. **`app/components/workspace/ChatMessage.tsx`**
   - Include mode badge in AI messages
   - Pass mode from response metadata

3. **`app/globals.css`** (already updated)
   - Mode badge styling exists
   - Add transition animations

### ModeBadge Component

```tsx
interface ModeBadgeProps {
  mode: SubPersonaMode;
  showTooltip?: boolean;
  size?: 'sm' | 'md';
}

const modeLabels: Record<SubPersonaMode, string> = {
  inquisitive: 'Exploring',
  devils_advocate: 'Challenging',
  encouraging: 'Validating',
  realistic: 'Grounding'
};

const modeTooltips: Record<SubPersonaMode, string> = {
  inquisitive: 'Asking questions to understand your idea better',
  devils_advocate: 'Testing your assumptions with tough questions',
  encouraging: 'Acknowledging strong thinking and building confidence',
  realistic: 'Ensuring your plans are grounded in reality'
};

function ModeBadge({ mode, showTooltip = true, size = 'sm' }: ModeBadgeProps) {
  return (
    <Tooltip content={modeTooltips[mode]} disabled={!showTooltip}>
      <span
        className={cn(
          'mode-badge',
          `mode-badge-${mode}`,
          size === 'sm' && 'mode-badge-sm'
        )}
      >
        {modeLabels[mode]}
      </span>
    </Tooltip>
  );
}
```

### CSS (already in globals.css)

```css
/* Mode Badge */
.mode-badge {
  font-family: var(--font-display);
  font-size: var(--text-xs);
  font-weight: 500;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  padding: var(--space-1) var(--space-3);
  border-radius: var(--radius-full);
  transition: all var(--transition-base);
}

.mode-badge-inquisitive {
  background: var(--mode-inquisitive);
  color: var(--ink);
}

.mode-badge-devils_advocate {
  background: var(--mode-advocate);
  color: var(--cream);
}

.mode-badge-encouraging {
  background: var(--mode-encouraging);
  color: var(--ink);
}

.mode-badge-realistic {
  background: var(--mode-realistic);
  color: var(--cream);
}
```

### Integration with Chat

```tsx
function AIMessage({ content, mode }: AIMessageProps) {
  return (
    <div className="chat-assistant">
      <div className="message-header">
        <span className="ai-name">Mary</span>
        {mode && <ModeBadge mode={mode} />}
      </div>
      <div className="message-content">
        {content}
      </div>
    </div>
  );
}
```

## Testing

### Unit Tests
- [ ] ModeBadge renders correctly for each mode
- [ ] Tooltip content matches mode
- [ ] Transition animation triggers

### Integration Tests
- [ ] Badge appears in chat messages
- [ ] Mode updates when API returns new mode

### Manual Testing
- [ ] Badge visible but not distracting
- [ ] Colors match design system
- [ ] Tooltip helpful for new users
- [ ] Mobile display works

## Dependencies

- Story 6.1 must be complete (mode in API response)
- Design system already has colors defined

## Out of Scope

- User mode selection (Post-MVP)
- Mode history view
- Analytics on mode usage

## Notes

This is a "nice-to-have" for MVP - the modes work without visible indicators. However, showing the mode helps users understand the methodology and builds trust in the system.

The labels ("Exploring", "Challenging", etc.) are user-friendly rather than technical ("inquisitive", "devils_advocate").
