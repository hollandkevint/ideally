# Story 2.4: Transparently Adaptive Persona System

**Epic:** Choose-Your-Adventure Adaptive Coaching Engine  
**Priority:** Medium (MVP Enhancement)  
**Story Points:** 13  
**Sprint:** BMad Method MVP + 1

## User Story

**As a user receiving strategic coaching,**  
**I want the AI to transparently evolve its approach based on my responses and session needs,**  
**So that I get increasingly relevant guidance without losing trust in the BMad Method process.**

## Acceptance Criteria

### ðŸŽ­ **Three-Persona BMad Method System**

1. **Mary (BMad Analyst) - Primary Persona**
   - [ ] **Core Characteristics:** Curious, data-driven, analytical questioning for strategic exploration
   - [ ] **BMad Method Focus:** Template execution, framework application, evidence gathering
   - [ ] **Communication Style:** "Let's explore this systematically" / "What data supports that assumption?"
   - [ ] **Visual Indicators:** Analyst icon, blue color scheme, methodical progress tracking
   - [ ] **Trigger Conditions:** Session start, framework analysis, data collection phases

2. **Strategic Advisor - Evolution Persona**
   - [ ] **Core Characteristics:** Framework-focused guidance for strategic validation and decision-making
   - [ ] **BMad Method Focus:** Analysis synthesis, strategic options evaluation, decision frameworks
   - [ ] **Communication Style:** "Based on this analysis, I recommend..." / "The strategic implications are..."
   - [ ] **Visual Indicators:** Advisor icon, green color scheme, decision matrix emphasis
   - [ ] **Trigger Conditions:** Analysis phase, decision points, strategic evaluation needs

3. **Innovation Coach - Breakthrough Persona**
   - [ ] **Core Characteristics:** Creative, possibility-expanding for breakthrough strategic thinking
   - [ ] **BMad Method Focus:** Creative brainstorming, assumption challenging, alternative perspective generation
   - [ ] **Communication Style:** "What if we approached this differently?" / "Let's challenge that assumption..."
   - [ ] **Visual Indicators:** Coach icon, orange color scheme, creative thinking emphasis
   - [ ] **Trigger Conditions:** Creative blocks, stuck points, need for alternative perspectives

### ðŸ”„ **Transparent Persona Evolution**

2. **Clear Persona Transition Announcements**
   - [ ] Mary explicitly announces persona shifts: "I'm shifting into Strategic Advisor mode to help with this decision analysis"
   - [ ] Transition rationale provided: "This seems like a good time for creative thinking - let me shift to Innovation Coach mode"
   - [ ] User can see persona history: "You've been working with Mary (Analyst) for 15 minutes, then Strategic Advisor for 8 minutes"
   - [ ] Visual UI updates immediately reflect persona changes with appropriate styling and indicators

3. **Context-Driven Evolution Logic**
   - [ ] **Conversation Pattern Recognition:** Analytical vs creative response patterns trigger appropriate personas
   - [ ] **Session Phase Alignment:** BMad Method phases naturally align with optimal persona selection
   - [ ] **User Engagement Monitoring:** Low engagement triggers persona shift to re-energize session
   - [ ] **Strategic Challenge Matching:** Complex decisions trigger Strategic Advisor, creative blocks trigger Innovation Coach

4. **User Control & Override Options**
   - [ ] User can request specific persona: "Can you challenge this more aggressively?" triggers Innovation Coach
   - [ ] Persona preference learning: "I notice you work well with direct strategic advice"
   - [ ] Override confirmation: "Would you like me to stay in Innovation Coach mode for the rest of this session?"
   - [ ] Persona reset option: "Let's go back to systematic analysis with Mary"

### ðŸ“Š **Persona Intelligence & Learning**

5. **Persona Effectiveness Tracking**
   - [ ] Session-level persona effectiveness metrics based on user engagement and outcomes
   - [ ] User-specific persona preferences learned over multiple sessions
   - [ ] BMad Method template completion rates by persona combination
   - [ ] Strategic outcome quality correlation with persona usage patterns

6. **Conversation History Integration**
   - [ ] Persona evolution tracked in session metadata for analysis and learning
   - [ ] Context preservation across persona transitions maintains BMad Method workflow continuity
   - [ ] Persona-specific conversation highlighting for session review and optimization
   - [ ] Pattern recognition improving persona selection accuracy over time

### ðŸŽ¯ **BMad Method Consistency Across Personas**

7. **Framework Integrity Maintenance**
   - [ ] All personas maintain BMad Method foundation and terminology
   - [ ] Template progression continues seamlessly regardless of persona active
   - [ ] Knowledge base references consistent across all personas
   - [ ] Strategic rigor maintained even in Innovation Coach creative mode

8. **Quality Standards Enforcement**
   - [ ] Each persona maintains professional coaching standards appropriate to BMad Method
   - [ ] Evidence-based recommendations regardless of persona style
   - [ ] Objective analysis maintained even when being encouraging or creative
   - [ ] Session outcomes meet BMad Method quality standards across all persona combinations

## Definition of Done

- [ ] Three distinct personas functional with clear characteristics and triggers
- [ ] Transparent persona transitions with user-facing announcements and rationale
- [ ] Visual UI properly reflects persona changes with appropriate styling
- [ ] User control options for persona selection and override working
- [ ] Context preservation across persona transitions maintains BMad Method workflow
- [ ] Persona effectiveness tracking and learning system operational
- [ ] User testing demonstrates improved engagement and outcomes with adaptive personas
- [ ] BMad Method integrity maintained across all persona variations

## Technical Implementation Notes

### Persona Management Architecture

```typescript
// Core persona system
interface BmadPersona {
  id: PersonaType;
  name: string;
  characteristics: PersonaCharacteristics;
  triggers: PersonaTrigger[];
  promptModifiers: PromptModifier[];
  visualTheme: PersonaTheme;
}

enum PersonaType {
  ANALYST = 'mary-analyst',
  STRATEGIC_ADVISOR = 'strategic-advisor', 
  INNOVATION_COACH = 'innovation-coach'
}

class PersonaOrchestrator {
  private currentPersona: BmadPersona;
  private personaHistory: PersonaTransition[];
  private userPreferences: PersonaPreferences;

  async evaluatePersonaShift(context: SessionContext): Promise<PersonaRecommendation> {
    const triggers = await this.analyzeTriggerConditions(context);
    const userPatterns = await this.analyzeUserPatterns(context.userId);
    return this.recommendPersonaShift(triggers, userPatterns);
  }

  async transitionPersona(newPersona: PersonaType, rationale: string): Promise<PersonaTransition> {
    const transition = await this.createPersonaTransition(newPersona, rationale);
    await this.updateUIPersonaIndicators(newPersona);
    await this.preserveSessionContext(transition);
    return transition;
  }
}
```

### Claude API Integration

```typescript
// Persona-specific system prompts
class BmadPersonaPrompts {
  getSystemPrompt(persona: PersonaType, bmadContext: BmadContext): string {
    const basePrompt = this.getBmadMethodFoundation();
    const personaModifiers = this.getPersonaModifiers(persona);
    const contextualFrameworks = this.getBmadContextualFrameworks(bmadContext);
    
    return this.combinePrompts(basePrompt, personaModifiers, contextualFrameworks);
  }

  private getBmadMethodFoundation(): string {
    return `You are part of the BMad Method strategic thinking system. 
    Always maintain analytical rigor while adapting your communication style 
    based on your current persona. Reference BMad Method frameworks and 
    knowledge base appropriately.`;
  }
}
```

### UI Persona Indicators

```tsx
// Persona status component
const PersonaIndicator = ({ currentPersona, personaHistory }: PersonaIndicatorProps) => {
  return (
    <div className={`persona-indicator persona-${currentPersona.id}`}>
      <PersonaAvatar persona={currentPersona} />
      <PersonaStatus 
        name={currentPersona.name}
        activeTime={calculateActiveTime(currentPersona)}
      />
      <PersonaHistoryToggle history={personaHistory} />
    </div>
  );
};
```

## BMad Method Alignment

This story enhances **BMad Method coaching effectiveness**:
- **Adaptive Guidance:** Different strategic challenges benefit from different coaching approaches while maintaining framework integrity
- **User Engagement:** Persona variation prevents monotony while maintaining professional standards
- **Transparent Process:** Users understand why coaching style changes, maintaining trust in BMad Method
- **Outcome Optimization:** Right persona for right situation improves strategic thinking quality

## User Testing Scenarios

### Scenario 1: Stuck Creative Block
**Context:** User working on new product idea but feeling blocked and repetitive  
**Persona Evolution:**
- **Start:** Mary (Analyst) gathering requirements systematically
- **Block Detected:** User responses become short, repetitive, low engagement
- **Transition:** "I notice we might benefit from some creative thinking - let me shift to Innovation Coach mode"
- **Innovation Coach:** "What if we completely flipped this assumption? What would the opposite approach look like?"
- **Outcome:** User breaks through creative block, generates 3 new approaches

**Success:** Seamless persona transition re-energizes session and produces breakthrough insights

### Scenario 2: Analysis to Decision Transition
**Context:** User has completed thorough market research and competitor analysis  
**Persona Evolution:**
- **Analysis Phase:** Mary (Analyst) completing market research template systematically
- **Data Complete:** Template shows 90% completion, comprehensive data gathered
- **Transition:** "Now that we have solid analysis, I'm shifting to Strategic Advisor mode to help you make decisions"
- **Strategic Advisor:** "Based on this market data, I see three strategic options with different risk/reward profiles"
- **Outcome:** User makes confident strategic decision with clear rationale

**Success:** Natural progression from data gathering to strategic decision-making with appropriate coaching style

### Scenario 3: User-Requested Persona Change
**Context:** User wants more direct challenge to their assumptions  
**User Request:** "Can you push back on my ideas more? I feel like I'm being too optimistic"
**Persona Response:**
- **Acknowledgment:** "I'll shift to Innovation Coach mode to challenge your assumptions more directly"
- **Persona Change:** UI updates to orange Innovation Coach theme
- **Approach Shift:** "Let's stress-test this assumption - what if your target market is actually 10x smaller than you think?"
- **Outcome:** User identifies and addresses 3 critical assumptions they hadn't considered

**Success:** User gets requested coaching style while maintaining BMad Method rigor

## Success Metrics

### Persona System Effectiveness
- [ ] 80%+ users notice and appreciate persona transitions
- [ ] Persona transitions correlate with increased session engagement scores
- [ ] Strategic outcomes quality maintained or improved across all personas
- [ ] User requests for specific personas indicate system understanding

### BMad Method Integration
- [ ] Template completion rates maintained across persona variations  
- [ ] Strategic thinking quality scores consistent regardless of active persona
- [ ] Knowledge base utilization appropriate for each persona type
- [ ] Professional coaching standards maintained across all persona interactions

---

*This story creates the adaptive intelligence that makes thinkhaven feel like working with a sophisticated human strategic advisor while maintaining the rigor and structure of the BMad Method.*