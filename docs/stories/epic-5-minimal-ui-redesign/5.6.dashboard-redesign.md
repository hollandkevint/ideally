# Story 5.6: Dashboard Redesign

## Status
Ready for Development

## Story
**As an** authenticated user managing my strategic sessions,
**I want** a clean dashboard with sidebar navigation and organized session cards,
**so that** I can easily find, access, and manage all my work in one place.

## Acceptance Criteria

### Functional Requirements
1. **Fixed Sidebar**: 240px sidebar with logo, "New Session" button, session list, and settings at bottom
2. **Welcome Header**: User greeting with name and quick stats (sessions, messages, insights)
3. **Session Grid**: Card-based grid layout for all user sessions
4. **Session Cards**: Clean cards with title, description preview, last updated, and quick actions
5. **Empty State**: Centered illustration and CTA when user has no sessions
6. **Quick Stats**: Small stat cards showing activity metrics (optional enhancement)

### Integration Requirements
7. Existing session creation flow works unchanged (BMad orchestrator)
8. Session cards navigate to correct workspace routes
9. Quick action menu integrates with existing session operations
10. Authentication and user context maintained correctly

### Quality Requirements
11. Sidebar remains fixed during scroll (main content scrolls)
12. Session cards have proper hover states and interactions
13. Grid layout is responsive (3 columns desktop, 2 tablet, 1 mobile)
14. Empty state provides clear next action for new users

## Tasks / Subtasks

- [ ] **Task 1: Fixed Sidebar Layout** (AC: 1)
  - [ ] Subtask 1.1: Create fixed sidebar container (240px width)
  - [ ] Subtask 1.2: Add Thinkhaven logo at top
  - [ ] Subtask 1.3: Implement "New Session" primary button
  - [ ] Subtask 1.4: Create session list component for quick access
  - [ ] Subtask 1.5: Add settings/account links at bottom

- [ ] **Task 2: Main Content Area Layout** (AC: 2, 11)
  - [ ] Subtask 2.1: Create main content area (left margin for sidebar)
  - [ ] Subtask 2.2: Add welcome header with user name
  - [ ] Subtask 2.3: Implement scrollable content area
  - [ ] Subtask 2.4: Add padding and max-width (1400px container)

- [ ] **Task 3: Welcome Header and Stats** (AC: 2, 6)
  - [ ] Subtask 3.1: Create welcome message ("Welcome back, {name}")
  - [ ] Subtask 3.2: Add quick stats cards (sessions, messages, insights)
  - [ ] Subtask 3.3: Style stats with subtle borders and icons
  - [ ] Subtask 3.4: Fetch and display user activity metrics

- [ ] **Task 4: Session Grid and Cards** (AC: 3, 4, 8, 12)
  - [ ] Subtask 4.1: Create responsive grid layout (3/2/1 columns)
  - [ ] Subtask 4.2: Design session card component
  - [ ] Subtask 4.3: Display title, description preview, timestamp
  - [ ] Subtask 4.4: Add quick action menu (three dots)
  - [ ] Subtask 4.5: Implement hover state with shadow elevation
  - [ ] Subtask 4.6: Wire up navigation to workspace routes

- [ ] **Task 5: Empty State** (AC: 5, 14)
  - [ ] Subtask 5.1: Create empty state component
  - [ ] Subtask 5.2: Add centered illustration or icon
  - [ ] Subtask 5.3: Display "Start your first strategic session" message
  - [ ] Subtask 5.4: Add prominent "New Session" CTA button

- [ ] **Task 6: Session Operations Integration** (AC: 7, 9)
  - [ ] Subtask 6.1: Wire up "New Session" button to session creator
  - [ ] Subtask 6.2: Implement quick actions (rename, delete, archive)
  - [ ] Subtask 6.3: Integrate with existing BMad session orchestrator
  - [ ] Subtask 6.4: Handle session creation success/error states

- [ ] **Task 7: Responsive and Testing** (AC: 13)
  - [ ] Subtask 7.1: Test sidebar behavior on mobile (collapsed or drawer)
  - [ ] Subtask 7.2: Validate grid responsiveness across breakpoints
  - [ ] Subtask 7.3: Ensure touch targets are adequate on mobile
  - [ ] Subtask 7.4: Test keyboard navigation for accessibility

## Dev Notes

### Previous Story Dependencies
**Requires Stories 5.1 and 5.2 Completion**: Design system and fonts must be in place for consistent sidebar and card styling.

### Previous Story Insights
From Stories 5.1-5.2:
- Design tokens available (colors, spacing, typography)
- DM Sans font for headings and body text
- Card component from shadcn/ui available
- Minimal design with subtle shadows

### Page Structure

**Dashboard Layout [Source: Original plan Section 4]:**

```
┌─────────────┬────────────────────────────────────┐
│             │  Welcome Header                    │
│  Sidebar    │  ┌──────┬──────┬──────┐           │
│  (240px)    │  │Stats │Stats │Stats │  (Quick)  │
│             │  └──────┴──────┴──────┘           │
│  Logo       │                                    │
│             │  Session Grid                      │
│  [New       │  ┌────────┬────────┬────────┐     │
│  Session]   │  │Session │Session │Session │     │
│             │  │Card 1  │Card 2  │Card 3  │     │
│  Sessions   │  └────────┴────────┴────────┘     │
│  - Session1 │  ┌────────┬────────┬────────┐     │
│  - Session2 │  │Session │Session │Session │     │
│  - Session3 │  │Card 4  │Card 5  │Card 6  │     │
│             │  └────────┴────────┴────────┘     │
│             │                                    │
│  Settings   │                                    │
│  Account    │                                    │
└─────────────┴────────────────────────────────────┘
```

### Component Specifications

**Fixed Sidebar:**
- Width: 240px
- Background: #f9f9f9 (subtle differentiation)
- Border right: 1px solid #e5e5e5
- Fixed position: Remains visible during scroll
- Padding: 24px 16px

**Sidebar Elements:**
- Logo: Thinkhaven (bold, 20px)
- "New Session" button: Full-width primary button
- Session list: Compact list with icons and truncated titles
- Settings/Account: Bottom-aligned links with icons

**Welcome Header:**
- Padding: 32px 48px
- Heading: "Welcome back, {firstName}" (text-2xl, bold)
- Subheading: Optional date or activity summary
- Background: white

**Quick Stats Cards:**
- Layout: Horizontal row, 3 cards
- Size: Small, equal width
- Content: Icon + number + label
- Style: Border, subtle background
- Metrics: "12 Sessions", "48 Messages", "8 Insights"

**Session Grid:**
- Columns: 3 on desktop (>1024px), 2 on tablet (768-1024px), 1 on mobile (<768px)
- Gap: 24px between cards
- Padding: 48px container padding

**Session Card:**
- Background: white
- Border: 1px solid #e5e5e5
- Border radius: 12px
- Padding: 24px
- Shadow: None default, subtle on hover
- Hover: Transform scale(1.02), shadow elevation

**Session Card Content:**
- Title: text-lg, font-semibold, 2-line max, ellipsis
- Description: text-sm, muted color, 3-line max, ellipsis
- Timestamp: text-xs, muted, "Last updated 2 hours ago"
- Quick actions: Three-dot menu (top-right corner)

**Empty State:**
- Centered vertically and horizontally
- Icon: Large (96px) illustration or icon
- Message: "Start your first strategic session"
- Subtext: "Create a new session to begin strategic thinking"
- CTA: Large primary "New Session" button

### File Locations

**Files to Modify:**
- `/apps/web/app/dashboard/page.tsx` - Complete dashboard redesign

**Related Files (reference only):**
- `/apps/web/app/components/ui/card.tsx` - Use for session cards
- `/apps/web/app/components/ui/button.tsx` - Use for CTAs
- `/apps/web/app/components/bmad/SessionManager.tsx` - Session creation integration
- `/apps/web/lib/bmad/session-orchestrator.ts` - Session operations

### Technical Implementation Details

**Implementation Approach [Source: Original plan Section 4]:**
1. **Sidebar layout** - Fixed position, responsive drawer on mobile
2. **Card-based design** - Use existing Card component with hover effects
3. **Quick stats** - Optional enhancement, can defer if time-constrained
4. **Empty state** - Critical for first-time user experience
5. **Session list** - Fetch from Supabase bmad_sessions table

**Data Integration:**
- Fetch user sessions: Query `bmad_sessions` table for current user
- Session count: Count total sessions for quick stats
- Last updated: Format timestamp (e.g., "2 hours ago", "Yesterday")
- Quick actions: Delete, rename, archive (use existing session operations)

**Responsive Behavior:**
- Desktop (>1024px): Full sidebar visible, 3-column grid
- Tablet (768-1024px): Sidebar collapses to icons only OR drawer, 2-column grid
- Mobile (<768px): Hamburger menu for sidebar, 1-column grid

**Session Card Actions:**
```typescript
// Quick action menu
const sessionActions = [
  { label: 'Open', action: () => router.push(`/workspace/${sessionId}`) },
  { label: 'Rename', action: () => handleRename(sessionId) },
  { label: 'Archive', action: () => handleArchive(sessionId) },
  { label: 'Delete', action: () => handleDelete(sessionId) },
];
```

### Performance Requirements

- **Page Load**: < 2 seconds (fetch sessions + render)
- **Session Cards**: Render all sessions efficiently (virtualization if >100 sessions)
- **Hover Interactions**: < 50ms response time

### Testing Requirements

**Testing Standards [Source: architecture/testing-strategy.md]:**
- E2E testing for session navigation
- Responsive design validation
- Accessibility audit for sidebar and cards

**Specific Test Scenarios:**

1. **Navigation Testing:**
   - "New Session" button opens session creator
   - Session card click navigates to workspace
   - Quick action menu operations work correctly
   - Settings/Account links navigate to correct pages

2. **Session Management:**
   - Sessions display correctly after creation
   - Session deletion removes card from grid
   - Session rename updates card title
   - Empty state appears when no sessions exist

3. **Responsive Testing:**
   - Desktop: Sidebar visible, 3-column grid
   - Tablet: Sidebar collapses, 2-column grid
   - Mobile: Sidebar drawer, 1-column grid
   - Touch targets >= 44px on mobile

4. **Accessibility Testing:**
   - Keyboard navigation works through sidebar and cards
   - Focus states visible and clear
   - Screen reader announces session information
   - ARIA labels on interactive elements

### Technical Constraints

**Integration Requirements [Source: Epic 5 dependencies]:**
- Must integrate with existing session orchestrator
- Must use existing shadcn/ui components
- Must maintain current session creation flow
- Must not modify session data structures

**Scope Limitations:**
- Dashboard UI redesign only - no session logic changes
- No new session management features
- No changes to BMad pathway system
- Focus on visual redesign and layout improvement

## Testing

### Testing Standards
- **E2E**: Playwright tests for dashboard flows
- **Unit**: Component tests for session cards
- **Accessibility**: axe DevTools scan
- **Visual**: Responsive design validation

### Specific Testing Requirements

1. **E2E Test Cases:**
   ```typescript
   test('user can create new session from dashboard', async ({ page }) => {
     await page.goto('/dashboard');
     await page.click('text=New Session');
     // Verify session creator opens
   });

   test('user can navigate to workspace from session card', async ({ page }) => {
     await page.goto('/dashboard');
     await page.click('.session-card >> nth=0');
     // Verify navigation to workspace
   });

   test('empty state shows when no sessions exist', async ({ page }) => {
     // Create fresh user with no sessions
     await page.goto('/dashboard');
     await expect(page.locator('text=Start your first strategic session')).toBeVisible();
   });
   ```

2. **Responsive Testing:**
   - Desktop (1440px): Full sidebar, 3-column grid
   - Tablet (768px): Sidebar behavior, 2-column grid
   - Mobile (375px): Drawer sidebar, 1-column stacked

3. **Performance Testing:**
   - Load time with 50 sessions < 2 seconds
   - Scroll performance smooth with many cards
   - Hover state response < 50ms

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-12-21 | 1.0 | Initial story creation for dashboard redesign | John (Product Manager) |

## Dev Agent Record

*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results

*This section will be populated by the QA Agent upon story completion*
