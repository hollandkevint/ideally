# Story 5.1: Design System Foundation

## Status
Ready for Development

## Story
**As a** designer and developer,
**I want** a consistent design token system with modern typography, colors, and spacing,
**so that** all UI components have a cohesive minimal aesthetic and I can build pages efficiently.

## Acceptance Criteria

### Functional Requirements
1. **Typography System**: DM Sans and DM Mono font families configured with larger base sizes and tighter line heights
2. **Color Palette**: Minimal black/white/gray palette with Notion-style blue accent color
3. **Spacing System**: Systematic 4px-based scale (8/16/24/32/48/64/96px)
4. **CSS Variables**: All design tokens available as CSS custom properties

### Integration Requirements
5. Existing component styles continue to work unchanged with new tokens
6. New design tokens follow established Tailwind CSS patterns
7. Integration with existing OKLCH color system maintained
8. Light mode only (dark mode remains disabled as per current design)

### Quality Requirements
9. Design tokens properly applied across all existing components
10. No visual regressions in existing UI elements
11. Typography scales correctly across responsive breakpoints
12. Color contrast meets WCAG 2.1 AA standards

## Tasks / Subtasks

- [ ] **Task 1: Update Typography System** (AC: 1, 4)
  - [ ] Subtask 1.1: Replace Geist font references with DM Sans/DM Mono variables
  - [ ] Subtask 1.2: Define font size scale (larger base sizes)
  - [ ] Subtask 1.3: Configure font weights (400 body, 600 headings, 700 display)
  - [ ] Subtask 1.4: Set line height values (tighter for headings)

- [ ] **Task 2: Implement Color Palette** (AC: 2, 4, 12)
  - [ ] Subtask 2.1: Define background colors (#ffffff, #f9f9f9)
  - [ ] Subtask 2.2: Define foreground colors (#191919, #6b6b6b)
  - [ ] Subtask 2.3: Define border color (#e5e5e5)
  - [ ] Subtask 2.4: Define primary accent (#0079ff, #0066d9 hover)
  - [ ] Subtask 2.5: Verify color contrast ratios for accessibility

- [ ] **Task 3: Configure Spacing System** (AC: 3, 4)
  - [ ] Subtask 3.1: Define base 4px unit
  - [ ] Subtask 3.2: Create spacing scale (8/16/24/32/48/64/96px)
  - [ ] Subtask 3.3: Configure container max-widths (1200px landing, 1400px app)
  - [ ] Subtask 3.4: Update utility classes for spacing system

- [ ] **Task 4: CSS Variable Configuration** (AC: 4, 5, 6)
  - [ ] Subtask 4.1: Define all design tokens as CSS custom properties
  - [ ] Subtask 4.2: Integrate with existing Tailwind theme configuration
  - [ ] Subtask 4.3: Ensure backward compatibility with existing components
  - [ ] Subtask 4.4: Document CSS variable naming conventions

- [ ] **Task 5: Testing and Validation** (AC: 9, 10, 11, 12)
  - [ ] Subtask 5.1: Visual regression testing across existing pages
  - [ ] Subtask 5.2: Responsive breakpoint testing
  - [ ] Subtask 5.3: Accessibility contrast verification
  - [ ] Subtask 5.4: Component rendering validation

## Dev Notes

### Previous Story Dependencies
**None** - This is the foundation story for Epic 5. All other stories in this epic depend on this story being completed first.

### Previous Story Insights
From existing UI implementation:
- Current system uses OKLCH color model with HSL fallbacks
- Tailwind CSS already configured with custom theme
- Light mode only (dark mode deliberately disabled in globals.css lines 131-273)
- Existing components use shadcn/ui patterns

### Design Specifications

**Typography [Source: Original plan Section 1]:**
```css
/* Font Families */
--font-sans: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
--font-mono: 'DM Mono', 'Courier New', monospace;

/* Font Sizes (larger base) */
--text-xs: 0.75rem;   /* 12px */
--text-sm: 0.875rem;  /* 14px */
--text-base: 1rem;    /* 16px */
--text-lg: 1.125rem;  /* 18px */
--text-xl: 1.25rem;   /* 20px */
--text-2xl: 1.5rem;   /* 24px */
--text-3xl: 1.875rem; /* 30px */
--text-4xl: 2.25rem;  /* 36px */

/* Line Heights (tighter for headings) */
--leading-tight: 1.25;
--leading-snug: 1.375;
--leading-normal: 1.5;
--leading-relaxed: 1.625;

/* Font Weights */
--font-normal: 400;
--font-semibold: 600;
--font-bold: 700;
```

**Color Palette [Source: Original plan Section 1]:**
```css
/* Base Colors */
--background: #ffffff;          /* Pure white */
--foreground: #191919;          /* Near black (not pure) */
--muted: #6b6b6b;              /* Muted text */
--border: #e5e5e5;             /* Subtle borders */
--surface: #f9f9f9;            /* Card backgrounds */

/* Primary Accent (Notion-style blue) */
--primary: #0079ff;
--primary-hover: #0066d9;

/* Status Colors (minimal) */
--success: #10b981;
--warning: #f59e0b;
--error: #ef4444;
```

**Spacing System [Source: Original plan Section 1]:**
```css
/* Base Unit: 4px */
--space-1: 0.25rem;  /* 4px */
--space-2: 0.5rem;   /* 8px */
--space-4: 1rem;     /* 16px */
--space-6: 1.5rem;   /* 24px */
--space-8: 2rem;     /* 32px */
--space-12: 3rem;    /* 48px */
--space-16: 4rem;    /* 64px */
--space-24: 6rem;    /* 96px */

/* Container Widths */
--container-landing: 1200px;
--container-app: 1400px;
```

### File Locations

**Files to Modify:**
- `/apps/web/app/globals.css` - Complete redesign of design tokens (274 lines currently)

**Related Files (reference only, do not modify):**
- `/apps/web/tailwind.config.js` - Tailwind configuration (uses CSS variables)
- `/apps/web/app/layout.tsx` - Font loading (will be updated in Story 5.2)

### Technical Implementation Details

**Implementation Approach [Source: Original plan Section 1]:**
1. **Preserve existing structure**: Keep current globals.css organization (base styles, components, utilities)
2. **Update CSS variables**: Replace existing color/typography variables with new design tokens
3. **Maintain OKLCH**: Keep existing OKLCH color definitions, update values
4. **Remove gradients**: Eliminate any background gradients per minimal design principle
5. **Simplify shadows**: Reduce shadow complexity (minimal shadows only)

**CSS Variable Organization:**
```css
@layer base {
  :root {
    /* Typography tokens */
    /* Color tokens */
    /* Spacing tokens */
    /* Border radius tokens */
    /* Shadow tokens (minimal) */
  }
}
```

**Backward Compatibility:**
- Existing component classes must continue to work
- Tailwind utility classes remain functional
- No breaking changes to component APIs

### Performance Requirements

- CSS bundle size should not increase significantly (target: <5% increase)
- Font loading should use font-display: swap for better performance
- CSS variables should have minimal runtime performance impact

### Testing Requirements

**Testing Standards [Source: architecture/testing-strategy.md]:**
- Visual regression testing required
- Component rendering validation
- Accessibility contrast verification
- Responsive breakpoint testing

**Specific Test Scenarios:**
- Verify all existing components render correctly with new design tokens
- Test typography scaling across mobile/tablet/desktop
- Validate color contrast meets WCAG 2.1 AA (4.5:1 for normal text, 3:1 for large text)
- Check that existing pages have no visual regressions

### Technical Constraints

**Integration Requirements [Source: Epic 5 dependencies]:**
- Must integrate with existing Tailwind CSS setup
- Must preserve current OKLCH color system structure
- Must maintain light-mode-only design (no dark mode)
- Must not break existing shadcn/ui components

**Scope Limitations:**
- Design tokens only - no component modifications in this story
- Typography variables defined but fonts not loaded (Story 5.2)
- No page-specific styling changes (Stories 5.3-5.7)
- Focus on foundation system only

## Testing

### Testing Standards
- **Visual Regression**: Compare before/after screenshots of key pages
- **Accessibility**: WAVE browser extension and axe DevTools
- **Responsive**: Chrome DevTools device emulation (mobile, tablet, desktop)
- **Component**: Manual verification of shadcn/ui components

### Specific Testing Requirements

1. **Typography Testing:**
   - Verify font-family variables render correctly in browser
   - Test font size scale across different components
   - Validate line height provides good readability
   - Check font weights display correctly

2. **Color Testing:**
   - Verify all color values render as expected
   - Test primary accent color visibility and contrast
   - Validate border colors are subtle but visible
   - Check background/foreground contrast ratio

3. **Spacing Testing:**
   - Verify spacing scale applies correctly to components
   - Test container max-widths on different screen sizes
   - Validate spacing is consistent and proportional

4. **Compatibility Testing:**
   - Test existing Button component renders correctly
   - Test existing Input component renders correctly
   - Test existing Card component renders correctly
   - Verify navigation components display properly
   - Check BMad pathway components work unchanged

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-12-21 | 1.0 | Initial story creation for design system foundation | John (Product Manager) |

## Dev Agent Record

*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results

*This section will be populated by the QA Agent upon story completion*
