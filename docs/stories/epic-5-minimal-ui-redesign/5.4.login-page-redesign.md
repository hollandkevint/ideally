# Story 5.4: Login Page Redesign

## Status
Ready for Development

## Story
**As a** returning user wanting to access my Thinkhaven account,
**I want** a clean, minimal login page that makes authentication simple and friction-free,
**so that** I can quickly sign in and get to my strategic work.

## Acceptance Criteria

### Functional Requirements
1. **Centered Form Layout**: Single-column form with max-width 400px, vertically and horizontally centered
2. **Google OAuth Primary**: Google sign-in button appears first with icon and outlined style
3. **Email/Password Option**: Clean email and password inputs below "OR" divider
4. **Single CTA**: Full-width primary button for email/password login
5. **Account Toggle**: "Don't have an account? Sign up" link at bottom
6. **Minimal Navigation**: Logo only in top-left corner (no full nav bar)

### Integration Requirements
7. Existing Supabase authentication logic works unchanged
8. OAuth flow maintains current behavior with Google provider
9. Form validation preserves existing error handling
10. Navigation to signup page and dashboard routes work correctly

### Quality Requirements
11. Form is accessible via keyboard (tab navigation works)
12. Input fields have proper labels and ARIA attributes
13. Error states display with clear, helpful messages
14. Loading states show during authentication

## Tasks / Subtasks

- [ ] **Task 1: Page Layout and Navigation** (AC: 1, 6)
  - [ ] Subtask 1.1: Create centered container (max-width 400px)
  - [ ] Subtask 1.2: Add minimal navigation with logo only
  - [ ] Subtask 1.3: Implement clean white background
  - [ ] Subtask 1.4: Set up responsive mobile layout

- [ ] **Task 2: Google OAuth Button** (AC: 2, 8)
  - [ ] Subtask 2.1: Create Google sign-in button with icon
  - [ ] Subtask 2.2: Style as outlined button (border, no fill)
  - [ ] Subtask 2.3: Wire up existing Google OAuth handler
  - [ ] Subtask 2.4: Add loading state during OAuth redirect

- [ ] **Task 3: Email/Password Form** (AC: 3, 4, 7, 9)
  - [ ] Subtask 3.1: Create "OR" divider below OAuth button
  - [ ] Subtask 3.2: Add email input with label and validation
  - [ ] Subtask 3.3: Add password input with label and toggle visibility
  - [ ] Subtask 3.4: Create full-width primary CTA button
  - [ ] Subtask 3.5: Wire up existing email/password authentication

- [ ] **Task 4: Account Toggle and Helper Text** (AC: 5)
  - [ ] Subtask 4.1: Add "Don't have an account? Sign up" link
  - [ ] Subtask 4.2: Style link with subtle color and underline
  - [ ] Subtask 4.3: Wire up navigation to /signup route
  - [ ] Subtask 4.4: Add "Forgot password?" link (if applicable)

- [ ] **Task 5: Form States and Validation** (AC: 9, 13, 14)
  - [ ] Subtask 5.1: Implement error state styling for inputs
  - [ ] Subtask 5.2: Add clear error messages for validation failures
  - [ ] Subtask 5.3: Show loading spinner on form submission
  - [ ] Subtask 5.4: Handle authentication errors gracefully

- [ ] **Task 6: Accessibility and Testing** (AC: 11, 12)
  - [ ] Subtask 6.1: Add proper labels and ARIA attributes
  - [ ] Subtask 6.2: Implement keyboard navigation support
  - [ ] Subtask 6.3: Test tab order and focus states
  - [ ] Subtask 6.4: Run accessibility audit (axe DevTools)

## Dev Notes

### Previous Story Dependencies
**Requires Stories 5.1 and 5.2 Completion**: Design system and fonts must be in place for consistent styling.

### Previous Story Insights
From Stories 5.1-5.2:
- Design tokens established (colors, typography, spacing)
- DM Sans font loaded for clean typography
- Minimal aesthetic with subtle borders and shadows
- Form components styled with new design system

### Page Structure

**Login Page Layout [Source: Original plan Section 3]:**

```
┌─────────────────────────────────────┐
│  ┌──────┐                           │  ← Logo (top-left)
│  │ Logo │                           │
│  └──────┘                           │
│                                     │
│         ┌───────────────┐           │
│         │               │           │
│         │  Login Form   │           │  ← Centered (400px max)
│         │               │           │
│         │ [Google]      │           │  ← OAuth button
│         │    OR         │           │  ← Divider
│         │ Email         │           │  ← Input fields
│         │ Password      │           │
│         │ [Log in]      │           │  ← Primary CTA
│         │               │           │
│         │ Sign up →     │           │  ← Toggle link
│         │               │           │
│         └───────────────┘           │
│                                     │
└─────────────────────────────────────┘
```

### Component Specifications

**Form Container:**
- Max-width: 400px
- Padding: 32px
- Background: white
- Border: none (clean background)
- Centered: margin auto, vertical centering with flexbox

**Google OAuth Button:**
- Width: 100%
- Height: 44px
- Border: 1px solid #e5e5e5
- Background: white
- Color: #191919
- Icon: Google "G" logo (left side)
- Text: "Continue with Google"
- Hover: Border darkens, subtle scale

**OR Divider:**
- Margin: 24px 0
- Line: 1px solid #e5e5e5
- Text: "OR" centered on line (background white)

**Input Fields:**
- Label: Above input, text-sm, font-semibold
- Input:
  - Height: 44px
  - Border: 1px solid #e5e5e5
  - Focus: Border #0079ff, outline none
  - Padding: 12px 16px
  - Border radius: 8px
- Helper text: Below input, text-xs, muted

**Primary CTA:**
- Width: 100%
- Height: 44px
- Background: #0079ff
- Color: white
- Font: font-semibold
- Border radius: 8px
- Hover: Background #0066d9

**Account Toggle Link:**
- Margin top: 24px
- Text: "Don't have an account? Sign up"
- Color: #6b6b6b (muted)
- Underline on hover
- Center aligned

### File Locations

**Files to Modify:**
- `/apps/web/app/login/page.tsx` - Complete login page redesign

**Related Files (reference only):**
- `/apps/web/app/components/ui/button.tsx` - Use for buttons
- `/apps/web/app/components/ui/input.tsx` - Use for form inputs
- `/apps/web/app/components/ui/label.tsx` - Use for input labels
- `/apps/web/lib/auth/AuthContext.tsx` - Existing auth integration

### Technical Implementation Details

**Implementation Approach [Source: Original plan Section 3]:**
1. **Minimal navigation** - Logo only, no full header
2. **Clean form design** - Labels above inputs, focus states, clear CTAs
3. **OAuth first** - Google button prominent, email/password secondary
4. **Simplified fields** - No confirm password, email + password only
5. **Helper text** - "Work email" label like Notion pattern

**Authentication Integration:**
- Use existing Supabase auth methods
- OAuth: `signInWithOAuth({ provider: 'google' })`
- Email/Password: `signInWithPassword({ email, password })`
- Error handling: Display Supabase error messages
- Redirect: After successful login, redirect to /dashboard

**Form Validation:**
- Email: Valid email format (HTML5 + custom validation)
- Password: Minimum 8 characters (match signup requirements)
- Submit disabled when validation fails
- Clear error messages for auth failures

### Performance Requirements

- **Page Load**: < 1 second (simple page, minimal assets)
- **Form Responsiveness**: Input response < 100ms
- **Auth Flow**: OAuth redirect < 2 seconds

### Testing Requirements

**Testing Standards [Source: architecture/testing-strategy.md]:**
- E2E testing for authentication flows
- Accessibility audit for forms
- Visual testing for responsive design

**Specific Test Scenarios:**

1. **Authentication Flow Testing:**
   - Google OAuth click initiates OAuth flow
   - Email/password login authenticates successfully
   - Invalid credentials show error message
   - Successful login redirects to dashboard
   - "Sign up" link navigates to signup page

2. **Form Validation:**
   - Empty email shows validation error
   - Invalid email format shows error
   - Short password shows validation error
   - Submit button disabled when form invalid

3. **Accessibility Testing:**
   - Keyboard tab navigation works correctly
   - Enter key submits form
   - Labels properly associated with inputs
   - Error messages announced to screen readers

4. **Responsive Testing:**
   - Mobile (375px): Form stacks correctly
   - Tablet (768px): Centered layout maintained
   - Desktop (1440px): Form centered with whitespace

### Technical Constraints

**Integration Requirements [Source: Epic 5 dependencies]:**
- Must preserve existing Supabase authentication logic
- Must maintain current OAuth configuration
- Must use existing shadcn/ui form components
- Must not introduce new authentication dependencies

**Scope Limitations:**
- Visual redesign only - no authentication logic changes
- No new auth providers or methods
- No password reset flow changes (existing flow maintained)
- Focus on clean, minimal UI for existing functionality

## Testing

### Testing Standards
- **E2E**: Playwright tests for auth flows (`tests/e2e/auth-flow.test.ts`)
- **Unit**: Component tests for form validation
- **Accessibility**: axe DevTools scan
- **Visual**: Manual cross-browser testing

### Specific Testing Requirements

1. **E2E Test Cases:**
   ```typescript
   test('user can log in with Google OAuth', async ({ page }) => {
     await page.goto('/login');
     await page.click('text=Continue with Google');
     // Verify OAuth redirect initiated
   });

   test('user can log in with email and password', async ({ page }) => {
     await page.goto('/login');
     await page.fill('input[type="email"]', 'user@example.com');
     await page.fill('input[type="password"]', 'password123');
     await page.click('text=Log in');
     // Verify redirect to dashboard
   });

   test('invalid credentials show error', async ({ page }) => {
     await page.goto('/login');
     await page.fill('input[type="email"]', 'wrong@example.com');
     await page.fill('input[type="password"]', 'wrongpass');
     await page.click('text=Log in');
     await expect(page.locator('text=Invalid credentials')).toBeVisible();
   });
   ```

2. **Accessibility Validation:**
   - All form fields have associated labels
   - Tab order is logical (email → password → submit)
   - Error messages have proper ARIA attributes
   - Focus states are visible and clear

3. **Visual Regression:**
   - Compare with current login page
   - Verify minimal design matches mockup
   - Check responsive breakpoints render correctly

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-12-21 | 1.0 | Initial story creation for login page redesign | John (Product Manager) |

## Dev Agent Record

*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results

*This section will be populated by the QA Agent upon story completion*
