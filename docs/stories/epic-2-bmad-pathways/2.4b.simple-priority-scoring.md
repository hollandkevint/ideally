# Story 2.4b: Simple Priority Scoring (Effort vs Impact)

## Status
Ready for Development

## Story
**As a** product manager who has input a feature concept,
**I want** to score my feature using simple effort vs impact criteria,
**so that** I can make data-driven prioritization decisions with clear visual guidance.

## Acceptance Criteria
1. **Effort Scoring Interface**: Simple 1-10 scale for development effort estimation
2. **Impact Scoring Interface**: Simple 1-10 scale for user/business impact assessment
3. **Priority Matrix Visualization**: Clear 2x2 grid showing feature positioning
4. **Score Guidance**: Helpful prompts for consistent scoring across features
5. **Results Integration**: Priority score feeds into session data for feature brief generation

## Tasks / Subtasks

- [x] Task 1: Create Priority Scoring UI Components (AC: 1, 2, 4)
  - [x] Subtask 1.1: Design effort scoring interface with 1-10 slider and guidance text
  - [x] Subtask 1.2: Design impact scoring interface with 1-10 slider and guidance text
  - [x] Subtask 1.3: Add scoring guidance tooltips and examples for consistency
  - [x] Subtask 1.4: Implement real-time score validation and feedback

- [x] Task 2: Build Priority Matrix Visualization (AC: 3)
  - [x] Subtask 2.1: Create 2x2 priority matrix component (High/Low Impact vs High/Low Effort)
  - [x] Subtask 2.2: Add feature positioning dot based on effort/impact scores
  - [x] Subtask 2.3: Implement quadrant labels ("Quick Wins", "Major Projects", etc.)
  - [x] Subtask 2.4: Add visual feedback and recommendations based on quadrant

- [x] Task 3: Priority Calculation Logic (AC: 5)
  - [x] Subtask 3.1: Implement simple priority score algorithm (Impact/Effort ratio)
  - [x] Subtask 3.2: Add priority categorization logic (Critical/High/Medium/Low)
  - [x] Subtask 3.3: Store priority data in session for feature brief generation
  - [x] Subtask 3.4: Integrate with existing BMad session state management

- [x] Task 4: Testing and Session Integration (All ACs)
  - [x] Subtask 4.1: Create unit tests for priority scoring components
  - [x] Subtask 4.2: Add tests for priority matrix visualization
  - [x] Subtask 4.3: Add integration tests for score calculation and storage
  - [x] Subtask 4.4: Create E2E test for complete priority scoring flow

## Dev Notes

### Previous Story Dependencies
**Requires Story 2.4a Completion**: Feature input data must be available before priority scoring can begin.

### Previous Story Insights
From Story 2.4a: Feature input data structure established in session management, and BMad pathway orchestration patterns are working.

### Data Models
**Priority Scoring Schema** [Source: Epic 2 simplified for MVP]:
```sql
-- Extend existing feature_input_data in bmad_sessions
{
  "feature_description": "string",
  "priority_scoring": {
    "effort_score": "number (1-10)",
    "impact_score": "number (1-10)",
    "calculated_priority": "number",
    "priority_category": "string",
    "quadrant": "string",
    "scoring_timestamp": "timestamp"
  }
}
```

**TypeScript Interface**:
```typescript
interface PriorityScoring {
  effort_score: number; // 1-10
  impact_score: number; // 1-10
  calculated_priority: number; // impact/effort ratio
  priority_category: 'Critical' | 'High' | 'Medium' | 'Low';
  quadrant: 'Quick Wins' | 'Major Projects' | 'Fill-ins' | 'Time Wasters';
  scoring_timestamp: Date;
}

interface PriorityMatrix {
  quadrants: {
    quickWins: { minImpact: 7, maxEffort: 4 };
    majorProjects: { minImpact: 7, minEffort: 5 };
    fillIns: { maxImpact: 6, maxEffort: 4 };
    timeWasters: { maxImpact: 6, minEffort: 5 };
  };
}
```

### API Specifications
**Priority Calculation Endpoint** [Source: following /api/bmad pattern]:
- `POST /api/bmad` with `action: 'calculate_priority'`
- Request: `{ effort_score: number, impact_score: number, session_id: string }`
- Response: `{ priority_score: number, category: string, quadrant: string, recommendations: string[] }`

**Priority Algorithm** [Source: simplified RICE framework]:
```typescript
const calculatePriority = (impact: number, effort: number): PriorityScoring => {
  const priority = Number((impact / effort).toFixed(2));

  const category = priority >= 2.0 ? 'Critical' :
                  priority >= 1.5 ? 'High' :
                  priority >= 1.0 ? 'Medium' : 'Low';

  const quadrant = impact >= 7 && effort <= 4 ? 'Quick Wins' :
                  impact >= 7 && effort >= 5 ? 'Major Projects' :
                  impact <= 6 && effort <= 4 ? 'Fill-ins' : 'Time Wasters';

  return { effort_score: effort, impact_score: impact, calculated_priority: priority, priority_category: category, quadrant, scoring_timestamp: new Date() };
};
```

### Component Specifications
**New Components Required** [Source: unified-project-structure.md]:
- `/apps/web/app/components/bmad/pathways/PriorityScoring.tsx` - Main scoring interface
- `/apps/web/app/components/bmad/pathways/PriorityMatrix.tsx` - Visual 2x2 matrix
- `/apps/web/app/components/bmad/pathways/ScoreSlider.tsx` - Reusable 1-10 scoring slider

**Enhanced Components**:
- `/apps/web/app/components/bmad/pathways/FeatureRefinementPathway.tsx` - Add priority scoring step

### File Locations
**New Files to Create** [Source: unified-project-structure.md]:
- `/apps/web/lib/bmad/pathways/priority-scoring.ts` - Priority calculation logic
- `/apps/web/lib/bmad/frameworks/simple-priority-matrix.ts` - Matrix positioning logic
- `/apps/web/lib/bmad/utils/scoring-guidance.ts` - Scoring help text and examples

**Files to Modify**:
- `/apps/web/app/api/bmad/route.ts` - Add calculate_priority action
- `/apps/web/lib/bmad/session-orchestrator.ts` - Priority scoring step integration
- `/apps/web/lib/bmad/types.ts` - Add PriorityScoring type

### Technical Implementation Details
**Priority Scoring Flow** [Source: Epic 2 simplified]:
1. **Effort Assessment (2 minutes)**: Simple 1-10 slider with development effort guidance
2. **Impact Assessment (2 minutes)**: Simple 1-10 slider with user/business impact guidance
3. **Matrix Visualization (1 minute)**: Real-time positioning in 2x2 grid
4. **Recommendations (1 minute)**: Quadrant-based recommendations and next steps

**Scoring Guidance Framework**:
- **Effort Scale**: 1=few hours, 5=weeks of work, 10=multiple quarters
- **Impact Scale**: 1=minor improvement, 5=significant user benefit, 10=game-changing
- **Visual Feedback**: Color coding for quadrants (green=Quick Wins, red=Time Wasters)

### Performance Requirements
**Priority Scoring Performance** [Source: Epic 2 simplified]:
- Priority calculation: <1 second
- Matrix visualization update: <500ms
- Session data save: <1 second
- Total step duration: 6 minutes maximum

### Testing Requirements
**Testing Standards** [Source: architecture/testing-strategy.md]:
- Unit tests: `/apps/web/tests/components/bmad/pathways/priority-scoring/`
- Integration tests: `/apps/web/tests/integration/priority-scoring.test.ts`
- E2E tests: `/apps/web/tests/e2e/priority-scoring-flow.test.ts`

**Specific Test Scenarios**:
- Priority score calculation accuracy with various input combinations
- Matrix visualization positioning for all quadrants
- Score slider validation and boundary conditions
- Session state persistence across pathway navigation
- Real-time matrix updates during scoring adjustments

### Technical Constraints
**Simplified Scope for MVP**:
- No complex RICE framework (Reach/Confidence factors) - keep simple Impact/Effort only
- No comparative analysis with other features - single feature focus
- No team scoring or consensus features - individual product manager use
- No advanced analytics or historical scoring comparison

**Integration Requirements**:
- Must consume feature input data from Story 2.4a
- Must prepare priority data for feature brief generation (Story 2.4c)
- Follow established BMad pathway patterns for navigation and state

## Testing

### Testing Standards
- **Test Location**: `/apps/web/tests/components/bmad/pathways/priority-scoring/`
- **Integration Tests**: `/apps/web/tests/integration/`
- **E2E Tests**: `/apps/web/tests/e2e/` with Playwright
- **Coverage**: Minimum 80% for priority calculation logic and visualization components

### Specific Testing Requirements
- Priority matrix quadrant calculation testing with edge cases
- Score slider component testing with various interaction patterns
- Visual matrix positioning accuracy testing
- Priority category assignment testing across score ranges
- Session integration testing for score persistence
- Real-time UI update testing during score adjustments

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-17 | 1.0 | Initial story creation - MVP priority scoring with effort vs impact only | Bob (Scrum Master) |
| 2025-09-17 | 1.1 | PM validation complete - promoted to Ready for Development | John (Product Manager) |

## Dev Agent Record

### Agent Model Used
Development agent: claude-sonnet-4-20250514
Implementation date: 2025-09-17

### Debug Log References
- Priority scoring implementation: app/components/bmad/pathways/PriorityScoring.tsx
- API endpoint implementation: app/api/bmad/route.ts calculate_priority action
- Session management integration: lib/bmad/session-orchestrator.ts

### Completion Notes List
*To be updated as tasks are completed*

### File List

**New Files Created:**
- `/apps/web/lib/bmad/pathways/priority-scoring.ts` - Priority calculation logic and analysis
- `/apps/web/lib/bmad/utils/scoring-guidance.ts` - Scoring guidance with examples and color coding
- `/apps/web/app/components/bmad/pathways/ScoreSlider.tsx` - Reusable 1-10 scoring slider component
- `/apps/web/app/components/bmad/pathways/PriorityScoring.tsx` - Main priority scoring interface
- `/apps/web/app/components/bmad/pathways/PriorityMatrix.tsx` - 2x2 priority matrix visualization
- `/apps/web/tests/lib/bmad/pathways/priority-scoring.test.ts` - Unit tests for priority logic
- `/apps/web/tests/components/bmad/pathways/priority-scoring.test.tsx` - Component tests for PriorityScoring
- `/apps/web/tests/components/bmad/pathways/priority-matrix.test.tsx` - Component tests for PriorityMatrix
- `/apps/web/tests/integration/priority-scoring-api.test.ts` - Integration tests for API endpoints
- `/apps/web/tests/e2e/priority-scoring-flow.test.ts` - E2E test for complete flow

**Modified Files:**
- `/apps/web/lib/bmad/types.ts` - Added PriorityScoring and PriorityMatrix interfaces
- `/apps/web/app/api/bmad/route.ts` - Added calculate_priority and save_priority_scoring actions

## QA Results

*This section will be populated by the QA Agent upon story completion*